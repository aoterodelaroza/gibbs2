# Copyright (c) 2011 Alberto Otero de la Roza <alberto@carbono.quimica.uniovi.es>,
# Víctor Luaña <victor@carbono.quimica.uniovi.es> and David
# Abbasi <david@carbono.quimica.uniovi.es>. Universidad de Oviedo. 
# 
# gibbs2 is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or (at
# your option) any later version.
# 
# gibbs2 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

# This file is automatically generated by makemake.awk 
# Set compiler and options in Makefile.inc
include Makefile.inc

BINS=gibbs2$(EXE)
BINS_dbg=gibbs2_dbg$(EXE)
OBJS= debye.o eos.o evfunc.o fit.o gibbs2.o gnuplot_templates.o param.o setvariables.o\
      tools.o topcalc.o varbas.o dgam.o
LIBS=slatec/libslatec.a minpack/libminpack.a pppack/libpppack.a 
INCLUDE=

%.o: %.f90
	$(FC) -c $(FCFLAGS) $(INCLUDE) -o $@ $<

%.o: %.f
	$(FC) -c $(FCFLAGS) $(INCLUDE) -o $@ $<

%.mod: %.o
	@if [ ! -f $@ ]; then rm $< ; $(MAKE) $< ; fi

# General targets

all: $(BINS)

debug: 
	DEBUG=1 $(MAKE) $(BINS_dbg)

clean:
	rm -f core *.mod *.o 
	cd slatec  ; $(MAKE) clean
	cd minpack ; $(MAKE) clean
	cd pppack  ; $(MAKE) clean

veryclean:
	rm -f core *.mod *.o
	cd slatec  ; $(MAKE) veryclean
	cd minpack ; $(MAKE) veryclean
	cd pppack  ; $(MAKE) veryclean

mrproper:
	rm -f core *.mod *.o $(BINS) $(BINS_dbg)
	cd slatec  ; $(MAKE) mrproper
	cd minpack ; $(MAKE) mrproper
	cd pppack  ; $(MAKE) mrproper

gibbs2$(EXE): $(OBJS) $(LIBS)
	$(FC) -o gibbs2$(EXE) $(LDFLAGS) $(OBJS) $(LIBS)

gibbs2_dbg$(EXE): $(OBJS) $(LIBS)
	$(FC) -o gibbs2_dbg$(EXE) $(LDFLAGS) $(OBJS) $(LIBS)

# Libraries, static object targets
slatec/libslatec.a: dummy
	cd slatec; DEBUG=$(DEBUG) $(MAKE) $(MFLAGS)

minpack/libminpack.a: dummy
	cd minpack; DEBUG=$(DEBUG) $(MAKE) $(MFLAGS)

pppack/libpppack.a: dummy
	cd pppack; DEBUG=$(DEBUG) $(MAKE) $(MFLAGS)

# Object dependencies
varbas.o topcalc.o tools.o setvariables.o gnuplot_templates.o gibbs2.o fit.o evfunc.o eos.o debye.o : param.mod
varbas.o topcalc.o setvariables.o gnuplot_templates.o gibbs2.o fit.o evfunc.o eos.o debye.o : tools.mod
varbas.o topcalc.o setvariables.o gibbs2.o fit.o eos.o debye.o : evfunc.mod
varbas.o gibbs2.o : fit.mod
topcalc.o setvariables.o gnuplot_templates.o gibbs2.o eos.o debye.o : varbas.mod
topcalc.o gibbs2.o debye.o : eos.mod
topcalc.o gibbs2.o : debye.mod
topcalc.o : gnuplot_templates.mod
gibbs2.o : topcalc.mod

# dummy
dummy: 
	@true
